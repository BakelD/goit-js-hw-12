{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '27888525-8999ed18604edf74585499e22';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport const fetchImages = async (query, currentPage) => {\n  const searchParams = {\n    key: API_KEY,\n    q: query,\n    page: currentPage,\n    per_page: 15,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n  };\n\n  try {\n    return await axios.get('', { params: searchParams });\n  } catch (error) {\n    console.log(error.message);\n  }\n};\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst getMarkUp = ({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) =>\n  ` <li class=\"gallery-item\">\n        <div class=\"gallery-thumb\"><a class=\"gallery-link\" href=\"${largeImageURL}\" ><img src=\"${webformatURL}\" alt=\"${tags}\"/></a></div>\n        <div class=\"gallery-info-wrapper\">\n          <div class=\"gallery-info-box\">\n            <span class=\"gallery-info-data\">Likes</span>\n            <span class=\"gallery-info-amount\">${likes}</span>\n          </div>\n          <div class=\"gallery-info-box\">\n            <span class=\"gallery-info-data\">Views</span>\n            <span class=\"gallery-info-amount\">${views}</span>\n          </div>\n          <div class=\"gallery-info-box\">\n            <span class=\"gallery-info-data\">Comments</span>\n            <span class=\"gallery-info-amount\">${comments}</span>\n          </div>\n          <div class=\"gallery-info-box\">\n            <span class=\"gallery-info-data\">Downloads</span>\n            <span class=\"gallery-info-amount\">${downloads}</span>\n          </div>\n        </div>\n      </li>`;\n\nexport const renderMarkUp = (items, elem, simpleLightbox) => {\n  const markUp = items.map(item => getMarkUp(item)).join('');\n\n  elem.insertAdjacentHTML('beforeend', markUp);\n  simpleLightbox.refresh();\n};\n\nexport const simpleLightbox = new SimpleLightbox('.gallery-link');\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { fetchImages } from './js/pixabay-api';\nimport { renderMarkUp, simpleLightbox } from './js/render-functions';\n\nconst refs = {\n  form: document.querySelector('.form'),\n  gallerylist: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  btnLoadMore: document.querySelector('.btn-load-more'),\n};\n\nconst itemsPerPage = 15;\nlet totalPages;\nlet currentPage;\nlet query;\n\nrefs.form.addEventListener('submit', async e => {\n  e.preventDefault();\n\n  currentPage = 1;\n  refs.gallerylist.innerHTML = '';\n  refs.loader.classList.add('is-visible');\n\n  query = e.target.elements['search-text'].value.trim();\n\n  if (!query) {\n    iziToast.error({\n      message: 'Please fill out the request!',\n      position: 'topRight',\n    });\n\n    clear(e);\n\n    return;\n  }\n\n  try {\n    const {\n      data: { hits: images, totalHits },\n    } = await fetchImages(query, currentPage);\n\n    if (!images.length) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n\n      clear(e);\n      return;\n    }\n\n    totalPages = Math.ceil(totalHits / itemsPerPage);\n\n    if (currentPage < totalPages) {\n      refs.btnLoadMore.classList.add('is-visible');\n    }\n\n    // refs.gallerylist.innerHTML = renderMarkUp(images);\n    // simpleLightbox.refresh();\n    renderMarkUp(images, refs.gallerylist, simpleLightbox);\n\n    e.target.elements['search-text'].value = '';\n    currentPage += 1;\n\n    const elemHeight = document\n      .querySelector('.gallery-item')\n      .getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: elemHeight * 2, // Scroll down by 2 times the element height\n      left: 0,\n      behavior: 'smooth', // Smooth scrolling\n    });\n  } catch (error) {\n    iziToast.error({\n      message: error.message,\n      position: 'topRight',\n    });\n  } finally {\n    refs.loader.classList.remove('is-visible');\n  }\n});\n\nrefs.btnLoadMore.addEventListener('click', async () => {\n  refs.btnLoadMore.disabled = true;\n  refs.loader.classList.add('is-visible');\n  try {\n    const {\n      data: { totalHits, hits: images },\n    } = await fetchImages(query, currentPage);\n\n    // refs.gallerylist.insertAdjacentHTML('beforeend', renderMarkUp(images));\n    // simpleLightbox.refresh();\n    renderMarkUp(images, refs.gallerylist, simpleLightbox);\n\n    if (currentPage === totalPages) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n\n      refs.btnLoadMore.classList.remove('is-visible');\n      return;\n    }\n\n    currentPage += 1;\n    refs.btnLoadMore.classList.add('is-visible');\n  } catch (error) {\n    iziToast.error({\n      message: error.message,\n      position: 'topRight',\n    });\n\n    console.log(error.message);\n  } finally {\n    refs.loader.classList.remove('is-visible');\n    refs.btnLoadMore.disabled = false;\n  }\n});\n\nconst clear = e => {\n  refs.loader.classList.remove('is-visible');\n  refs.btnLoadMore.classList.remove('is-visible');\n  e.target.elements['search-text'].value = '';\n};\n"],"names":["API_KEY","axios","fetchImages","query","currentPage","searchParams","error","getMarkUp","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderMarkUp","items","elem","simpleLightbox","markUp","item","SimpleLightbox","refs","itemsPerPage","totalPages","e","iziToast","clear","images","totalHits","elemHeight"],"mappings":"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"}